<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <title>Render Positioning Test</title>
        <script src="https://cdn.jsdelivr.net/npm/@svgdotjs/svg.js@3.0/dist/svg.min.js"></script>
        <script src="https://unpkg.com/transformation-matrix@2"></script>
        <script type="text/javascript">
            document.addEventListener("DOMContentLoaded", function(event) {
                let {scale, rotate, translate, compose, applyToPoint} = window.TransformationMatrix;
                var draw = SVG().addTo("#drawing").size("100%", "100%");
                var myRect = draw.defs().rect(100, 100).id("myRect").fill("red").stroke({color: "black", width: 2});

                var factor = .5;
                var matrix = compose(scale(factor, factor, 50, 50));
                var newpt = applyToPoint(matrix, {x: 0, y: 0});

                var group = draw.group().id("stack");
                var used = [];
                for (let i = 0; i < 10; i++) {
                    var use = group.use(myRect);
                    used.push(use);
                    use.dmove(0 - newpt.x, 0 - newpt.y);
                    use.scale(factor * 0.95);
                }
                let dy = 0;
                for (var piece of used) {
                    piece.dy(dy);
                    dy += piece.bbox().height * .5;
                }
            });
        </script>
    </head>
    <body>
        <section>
            <h1>Render Positioning Test</h1>
            <div id="drawing" style="width: 100%; height: 100%; margin: 0; padding: 0"></div>
        </section>
    </body>
</html>